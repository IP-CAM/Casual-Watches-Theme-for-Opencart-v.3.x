{% from 'cw/template/components/breadcrumbs.twig' import breadcrumbs %}
{% from 'cw/template/components/product_teaser.twig' import product_teaser %}
{% set labels = {
    'button_cart': button_cart,
} %}

{{ header }}

<div class="container pt-1 pb-1">
    {{ breadcrumbs(breadcrumbs) }}
</div>

<div class="container">
    <h1 class="category__title">
        {{ heading_title }}
    </h1>
</div>


<div class="container">
    <div class="row">
        {{ column_left }}

        {% if column_left and column_right %}
            {% set class = 'col-sm-6' %}
        {% elseif column_left or column_right %}
            {% set class = 'col-sm-9' %}
        {% else %}
            {% set class = 'col' %}
        {% endif %}

        <div class="{{ class }}">
            {{ content_top }}

            {# Sub-categories #}
            {% if categories %}
                <div class="sub-categories">
                    <h3>{{ text_refine }}</h3>
                    {% if categories|length <= 5 %}
                        <div class="row">
                            <div class="col-sm-3">
                                <ul class="sub-category__list">
                                    {% for category in categories %}
                                        <li class="sub-category__item">
                                            <a class="sub-category__link" href="{{ category.href }}">{{ category.name }}</a>
                                        </li>
                                    {% endfor %}
                                </ul>
                            </div>
                        </div>
                    {% else %}
                        <div class="row">
                            {% for category in categories|batch((categories|length / 4)|round(1, 'ceil')) %}
                                <div class="col-sm-3">
                                    <ul class="sub-category__list">
                                    {% for child in category %}
                                        <li class="sub-category__item">
                                            <a class="sub-category__link" href="{{ child.href }}">{{ child.name }}</a>
                                        </li>
                                    {% endfor %}
                                    </ul>
                                </div>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
            {% endif %}
            {# End Sub-categories #}

            {# Products #}
            {% if products %}
                <ul class="sorting">
                    {% for sorts in sorts %}
                        <li class="sorting__item">
                            {% if sorts.value == '%s-%s'|format(sort, order) %}
                                <span class="sorting__current">{{ sorts.text }}</span>
                            {% else %}
                                <a href="{{ sorts.href }}" class="sorting__link">{{ sorts.text }}</a>
                            {% endif %}
                        </li>
                    {% endfor %}
                </ul>

                <div class="row">
                    {% for product in products %}
                        <div class="col-4">
                            {{ product_teaser(product, labels) }}
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
            {# End Products #}

            {% if not categories and not products %}
                {{ text_no_results }} <a href="{{ continue }}">{{ button_continue }}</a>
            {% else %}
                <div>{{ pagination }}</div>
                <div class="category__footnote">{{ results }}</div>
            {% endif %}

            {{ content_bottom }}

            {# Description #}
            {% if thumb or description %}
                <div class="row">
                {% if thumb %}
                    <div class="col-sm-2"><img src="{{ thumb }}" alt="{{ heading_title }}" title="{{ heading_title }}" class="img-thumbnail"/></div>
                {% endif %}
                {% if description %}
                    <div class="col-sm-10">{{ description }}</div>
                {% endif %}
                </div>
                <hr/>
            {% endif %}
            {# End Description #}
        </div>

        {{ column_right }}
    </div>
</div>

{{ footer }}
